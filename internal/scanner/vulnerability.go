package scanner

import (
	"github.com/roomkangali/dursgo/internal/httpclient"
	"github.com/roomkangali/dursgo/internal/renderer"
	"sync"
)

type VulnerabilityResult struct {
	VulnerabilityType string                 `json:"VulnerabilityType"`
	URL               string                 `json:"URL"`
	Parameter         string                 `json:"Parameter,omitempty"`
	Payload           string                 `json:"Payload,omitempty"`
	Location          string                 `json:"Location,omitempty"`
	Details           string                 `json:"Details"`
	Severity          string                 `json:"severity,omitempty"`
	Evidence          string                 `json:"evidence,omitempty"`
	Remediation       string                 `json:"remediation,omitempty"`
	ScannerName       string                 `json:"scanner_name,omitempty"`
	CVE               string                 `json:"cve,omitempty"`
	Enrichment        map[string]interface{} `json:"enrichment,omitempty"`
	AIAnalysis        string                 `json:"ai_analysis,omitempty"`
}

type ScannerOptions struct {
	Concurrency        int
	OASTDomain         string
	OASTCorrelationMap *sync.Map
	Fingerprint        map[string]string
	UserID             int
	Renderer           *renderer.Renderer
	Client             *httpclient.Client
	GraphQLEndpoint    string
	Config             map[string]interface{} `json:"config,omitempty"`
}
